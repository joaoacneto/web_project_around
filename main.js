!function(){"use strict";const e=new class{constructor({baseUrl:e,headers:t}){this.baseUrl=e,this.headers=t}getInitialCards(){return fetch(`${this.baseUrl}/cards`,{headers:this.headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getInfo(){return fetch(`${this.baseUrl}/users/me`,{headers:this.headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}setInfo(e,t){return console.log(e,t),fetch(`${this.baseUrl}/users/me`,{method:"PATCH",headers:this.headers,body:JSON.stringify({name:e,about:t})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addNewCard(e,t){return fetch(`${this.baseUrl}/cards`,{method:"POST",headers:this.headers,body:JSON.stringify({name:e,link:t})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}setLiked(e){return fetch(`${this.baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this.headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}setDisliked(e){return fetch(`${this.baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this.headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}deleteCard(e){return fetch(`${this.baseUrl}/cards/${e}`,{method:"DELETE",headers:this.headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}editAvatar(e){return fetch(`${this.baseUrl}/users/me/avatar`,{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}}({baseUrl:"https://around-api.pt-br.tripleten-services.com/v1",headers:{authorization:"29bc26b9-99c7-44cc-b9cc-b9d2104c9ab6","Content-Type":"application/json"}});class t{constructor(e,t,s,n,r,o){this._name=e.name,this._link=e.link,this._isLiked=e.isLiked,this._id=e._id,this._owner=e.owner,this._template=document.querySelector(t).content.querySelector(".element"),this._handleCardClick=s,this._handleCardDelete=n,this._userId=r,this._handleCardLike=o}_createCardElement(){const e=this._template.cloneNode(!0),t=e.querySelector(".element__image"),s=e.querySelector(".element__title"),n=e.querySelector(".element__image-heart"),r=e.querySelector(".element__delete");return this._userId!==this._owner&&(r.style.display="none"),t.src=this._link,t.alt=this._name,s.textContent=this._name,this._isLiked&&n.classList.toggle("element__image-heart-liked"),this._setEventListeners(n,r,t),e}_handleHeartClick=e=>{e.target.classList.toggle("element__image-heart-liked"),this._handleCardLike(this._id,this._isLiked)};_handleTrashClick=e=>{this._handleCardDelete(e.target.closest(".element"),this._id)};_setEventListeners(e,t,s){e.addEventListener("click",this._handleHeartClick),t.addEventListener("click",this._handleTrashClick),s.addEventListener("click",(()=>this._handleCardClick(this._link,this._name)))}createCard(){return this._createCardElement()}}class s{constructor(e,t){this._config=e,this._formElement=t,this._inputList=Array.from(t.querySelectorAll(this._config.inputSelector)),this._buttonElement=t.querySelector(this._config.submitButtonSelector)}_showInputError(e,t){const s=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._config.inputErrorClass),s.textContent=t,s.classList.add(this._config.errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._config.inputErrorClass),t.classList.remove(this._config.errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._config.inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._config.inactiveButtonClass),this._buttonElement.disabled=!1)}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners(),this._toggleButtonState()}}class n{constructor({items:e,renderer:t},s){this._items=e,this._renderer=t,this._container=document.querySelector(s)}renderItems(){this._items.forEach((e=>this._renderer(e)))}addItem(e){this._container.prepend(e)}}class r{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popup.classList.add("popup__opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup__opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popup.addEventListener("click",(e=>{console.log(e.target),(e.target.classList.contains("popup__opened")||e.target.classList.contains("popup__close"))&&this.close()}))}}class o extends r{constructor(e,t){super(e),this._handleFormSubmit=t,this._form=this._popup.querySelector(".popup__form"),this._inputList=Array.from(this._form.querySelectorAll(".popup__input"))}_getInputValues(){return this._inputValues={},this._inputList.forEach((e=>{this._inputValues[e.name]=e.value})),this._inputValues}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}close(){super.close(),this._form.reset()}open(){super.open()}}let i;e.getInfo().then((e=>{i=e._id,_.setUserInfo({name:e.name,job:e.about}),_.setUserAvatar({avatar:e.avatar})})).catch((e=>{console.log(e)}));const a=(t,s)=>{s?e.setDisliked(t).then((e=>{console.log(e)})):e.setLiked(t).then((e=>{console.log(e)}))},l=new class extends r{constructor(e,t){super(e),this._popup=document.querySelector(e),this._confirmationButton=document.querySelector(".popup__delete-card"),this._handleDeleteCard=t}setEventListeners(){super.setEventListeners(),this._confirmationButton.addEventListener("click",(()=>{this._handleDeleteCard(this._card,this._cardId)}))}open(e,t){this._card=e,this._cardId=t,super.open()}}("#delete-card",((t,s)=>{const n=document.querySelector("#temCerteza");n.textContent="Deletando...",e.deleteCard(s).then((()=>{t.remove(),l.close()})).finally((()=>{n.textContent="Sim"}))}));let c;l.setEventListeners(),e.getInitialCards().then((e=>{c=new n({items:e,renderer:e=>{const s=new t(e,"#card-template",u,((e,t)=>{l.open(e,t)}),i,((e,t)=>{a(e,t)})).createCard();c.addItem(s)}},".elements"),c.renderItems()})).catch((e=>{console.log(e)}));const d={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-button",inactiveButtonClass:"popup__save-button_disabled",inputErrorClass:"invalido",errorClass:"popup__msg-error"},h=new class extends r{open(e,t){const s=this._popup.querySelector(".image__popup-image"),n=this._popup.querySelector(".image__popup-subtitle");s.src=t,s.alt=e,n.textContent=e,super.open()}}(".image__popup");h.setEventListeners();const u=(e,t)=>{console.log("entrou"),h.open(t,e)};new s(d,document.querySelector(".popup__form")).enableValidation(),new s(d,document.querySelector(".add__form")).enableValidation(),new s(d,document.querySelector(".avatar__form")).enableValidation();const _=new class{constructor({nameSelector:e,jobSelector:t,avatarSelector:s}){this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t),this._avatarElement=document.querySelector(s)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo({name:e,job:t}){this._nameElement.textContent=e,this._jobElement.textContent=t}setUserAvatar({avatar:e}){this._avatarElement.src=e}}({nameSelector:".profile__content-name",jobSelector:".profile__content-job",avatarSelector:".profile__content-picture"}),p=new o("#edit-profile",(t=>{const s=document.querySelector("#btnEditProfile");s.textContent="Salvando...",console.log(t),e.setInfo(t.name,t.title).then((e=>{console.log(e),_.setUserInfo({name:e.name,job:e.about})})).catch((e=>{console.log(e)})).finally((()=>{s.textContent="Salvar"})),p.close()}));p.setEventListeners();const m=new o("#edit-avatar",(t=>{const s=document.querySelector("#btnEditAvatar");s.textContent="Salvando...",e.editAvatar(t.avatar).then((e=>{_.setUserAvatar({avatar:e.avatar})})).catch((e=>{console.log(e)})).finally((()=>{s.textContent="Salvar"})),m.close()}));m.setEventListeners(),document.querySelector(".profile__content-pencil").addEventListener("click",(()=>{m.open()}));const E=new o("#add-card",(s=>{const n=document.querySelector("#btnAddSubmit");n.textContent="Criando...",e.addNewCard(s.name,s.URL).then((e=>{const s=new t({name:e.name,link:e.link,isLiked:e.isLiked,owner:e.owner},"#card-template",u,((e,t)=>{l.open(e,t)}),i,((e,t)=>{a(e,t)}));c.addItem(s.createCard())})).finally((()=>{n.textContent="Criar"})),E.close()}));E.setEventListeners(),document.querySelector(".profile__content-edit").addEventListener("click",(()=>{const e=_.getUserInfo();document.querySelector(".popup__name-input").value=e.name,document.querySelector(".popup__title-input").value=e.job,p.open()})),document.querySelector(".profile__add-button").addEventListener("click",(()=>{E.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LElBRXpCaUQsRUFBZ0I5QyxvQkFDTXBGLFNBQVNDLGNBQWMsNEJBQy9CMEIsaUJBQWlCLFNBQVMsS0FDdEN1RyxFQUFnQmxELE1BQU0sSUFHeEIsTUFBTW9ELEVBQWUsSUFBSTlDLEVBQWMsYUFBY3lDLElBQ25ELE1BQU1NLEVBQWVySSxTQUFTQyxjQUFjLGlCQUM1Q29JLEVBQWFuSCxZQUFjLGFBQzNCbEUsRUFDR3dCLFdBQVd1SixFQUFTL0osS0FBTStKLEVBQVNPLEtBQ25DL0ssTUFBTXlJLElBQ0wsTUFBTXVDLEVBQVUsSUFBSXRKLEVBQ2xCLENBQ0VqQixLQUFNZ0ksRUFBT2hJLEtBQ2JTLEtBQU11SCxFQUFPdkgsS0FDYmtCLFFBQVNxRyxFQUFPckcsUUFDaEJHLE1BQU9rRyxFQUFPbEcsT0FFaEIsaUJBQ0FWLEdBQ0EsQ0FBQ3lILEVBQU1sSSxLQUNMNEgsRUFBc0J2QixLQUFLNkIsRUFBTWxJLEVBQU8sR0FFMUNXLEdBQ0EsQ0FBQ1gsRUFBUWdCLEtBQ1BKLEVBQWVaLEVBQVFnQixFQUFRLElBR25DcUgsRUFBWXhDLFFBQVErRCxFQUFRM0csYUFBYSxJQUUxQ21GLFNBQVEsS0FDUHNCLEVBQWFuSCxZQUFjLE9BQU8sSUFHdENrSCxFQUFhbkQsT0FBTyxJQUV0Qm1ELEVBQWFoRCxvQkFFTXBGLFNBQVNDLGNBQWMsMEJBQy9CMEIsaUJBQWlCLFNBQVMsS0FDbkMsTUFBTTZHLEVBQU92QyxFQUFTNEIsY0FDdEI3SCxTQUFTQyxjQUFjLHNCQUFzQjZGLE1BQVEwQyxFQUFLeEssS0FDMURnQyxTQUFTQyxjQUFjLHVCQUF1QjZGLE1BQVEwQyxFQUFLckMsSUFDM0QyQixFQUFpQjlDLE1BQU0sSUFHUGhGLFNBQVNDLGNBQWMsd0JBQy9CMEIsaUJBQWlCLFNBQVMsS0FDbEN5RyxFQUFhcEQsTUFBTSxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL3NjcmlwdHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9zY3JpcHRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL3NjcmlwdHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvc2NyaXB0cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9zY3JpcHRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9zY3JpcHRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL3NjcmlwdHMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL3NjcmlwdHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9zY3JpcHRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9zY3JpcHRzL1VzZXJJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgdGhpcy5iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLmhlYWRlcnMgPSBoZWFkZXJzO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuXG4gIGdldEluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgc2V0SW5mbyhuYW1lLCBhYm91dCkge1xuICAgIGNvbnNvbGUubG9nKG5hbWUsIGFib3V0KTtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICBhYm91dDogYWJvdXQsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cblxuICBhZGROZXdDYXJkKG5hbWUsIGxpbmspIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgIGxpbms6IGxpbmssXG4gICAgICB9KSxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cblxuICBzZXRMaWtlZChjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgc2V0RGlzbGlrZWQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuXG4gIGVkaXRBdmF0YXIoYXZhdGFyKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGF2YXRhcjogYXZhdGFyLFxuICAgICAgfSksXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydCBjb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkucHQtYnIudHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCIyOWJjMjZiOS05OWM3LTQ0Y2MtYjljYy1iOWQyMTA0YzlhYjZcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuIiwiaW1wb3J0IHsgYXBpIH0gZnJvbSBcIi4vQXBpLmpzXCI7XG5cbmV4cG9ydCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoXG4gICAgZGF0YSxcbiAgICB0ZW1wbGF0ZVNlbGVjdG9yLFxuICAgIGhhbmRsZUNhcmRDbGljayxcbiAgICBoYW5kbGVDYXJkRGVsZXRlLFxuICAgIHVzZXJJZCxcbiAgICBoYW5kbGVDYXJkTGlrZVxuICApIHtcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5faXNMaWtlZCA9IGRhdGEuaXNMaWtlZDtcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xuICAgIHRoaXMuX293bmVyID0gZGF0YS5vd25lcjtcbiAgICB0aGlzLl90ZW1wbGF0ZSA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0ZW1wbGF0ZVNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50XCIpO1xuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcbiAgICB0aGlzLl9oYW5kbGVDYXJkRGVsZXRlID0gaGFuZGxlQ2FyZERlbGV0ZTtcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XG4gICAgdGhpcy5faGFuZGxlQ2FyZExpa2UgPSBoYW5kbGVDYXJkTGlrZTtcbiAgfVxuXG4gIF9jcmVhdGVDYXJkRWxlbWVudCgpIHtcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IHRoaXMuX3RlbXBsYXRlLmNsb25lTm9kZSh0cnVlKTtcbiAgICBjb25zdCBjYXJkSW1hZ2UgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2ltYWdlXCIpO1xuICAgIGNvbnN0IGNhcmRUaXRsZSA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fdGl0bGVcIik7XG4gICAgY29uc3QgY2FyZEhlYXJ0ID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19pbWFnZS1oZWFydFwiKTtcbiAgICBjb25zdCB0cmFzaEljb24gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2RlbGV0ZVwiKTtcblxuICAgIGlmICh0aGlzLl91c2VySWQgIT09IHRoaXMuX293bmVyKSB7XG4gICAgICB0cmFzaEljb24uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgIH1cblxuICAgIGNhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xuICAgIGNhcmRJbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xuICAgIGNhcmRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG4gICAgaWYgKHRoaXMuX2lzTGlrZWQpIHtcbiAgICAgIGNhcmRIZWFydC5jbGFzc0xpc3QudG9nZ2xlKFwiZWxlbWVudF9faW1hZ2UtaGVhcnQtbGlrZWRcIik7XG4gICAgfVxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKGNhcmRIZWFydCwgdHJhc2hJY29uLCBjYXJkSW1hZ2UpO1xuXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xuICB9XG5cbiAgX2hhbmRsZUhlYXJ0Q2xpY2sgPSAoZXZ0KSA9PiB7XG4gICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKFwiZWxlbWVudF9faW1hZ2UtaGVhcnQtbGlrZWRcIik7XG4gICAgdGhpcy5faGFuZGxlQ2FyZExpa2UodGhpcy5faWQsIHRoaXMuX2lzTGlrZWQpO1xuICB9O1xuXG4gIF9oYW5kbGVUcmFzaENsaWNrID0gKGV2dCkgPT4ge1xuICAgIHRoaXMuX2hhbmRsZUNhcmREZWxldGUoZXZ0LnRhcmdldC5jbG9zZXN0KFwiLmVsZW1lbnRcIiksIHRoaXMuX2lkKTtcbiAgfTtcblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoY2FyZEhlYXJ0LCB0cmFzaEljb24sIGNhcmRJbWFnZSkge1xuICAgIGNhcmRIZWFydC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlSGVhcnRDbGljayk7XG4gICAgdHJhc2hJY29uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVUcmFzaENsaWNrKTtcbiAgICBjYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XG4gICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sodGhpcy5fbGluaywgdGhpcy5fbmFtZSlcbiAgICApO1xuICB9XG5cbiAgY3JlYXRlQ2FyZCgpIHtcbiAgICByZXR1cm4gdGhpcy5fY3JlYXRlQ2FyZEVsZW1lbnQoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5fY29uZmlnID0gY29uZmlnO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcbiAgICAgIGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fY29uZmlnLmlucHV0U2VsZWN0b3IpXG4gICAgKTtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIHRoaXMuX2NvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3RvclxuICAgICk7XG4gIH1cblxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcuaW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fY29uZmlnLmVycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcbiAgICApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5lcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xuICAgIH0pO1xuICB9XG5cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHRoaXMuX3JlbmRlcmVyKGl0ZW0pKTtcbiAgfVxuXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG59XG4iLCJleHBvcnQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZChcInBvcHVwX19vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX19vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGV2dC50YXJnZXQpO1xuICAgICAgaWYgKFxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwX19vcGVuZWRcIikgfHxcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9fY2xvc2VcIilcbiAgICAgICkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9faW5wdXRcIikpO1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIHRoaXMuX2lucHV0VmFsdWVzID0ge307XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICB0aGlzLl9pbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiB0aGlzLl9pbnB1dFZhbHVlcztcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICB9KTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbn1cbiIsImltcG9ydCB7IENhcmQgfSBmcm9tIFwiLi9DYXJkLmpzXCI7XG5pbXBvcnQgeyBGb3JtVmFsaWRhdG9yIH0gZnJvbSBcIi4vRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IHsgU2VjdGlvbiB9IGZyb20gXCIuL1NlY3Rpb24uanNcIjtcbmltcG9ydCB7IFBvcHVwV2l0aEltYWdlIH0gZnJvbSBcIi4vUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCB7IFBvcHVwV2l0aEZvcm0gfSBmcm9tIFwiLi9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgeyBVc2VySW5mbyB9IGZyb20gXCIuL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgeyBhcGkgfSBmcm9tIFwiLi9BcGkuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtYXRpb24gZnJvbSBcIi4vUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzXCI7XG5cbmxldCB1c2VySWQ7XG5cbmFwaVxuICAuZ2V0SW5mbygpXG4gIC50aGVuKChyZXN1bHQpID0+IHtcbiAgICB1c2VySWQgPSByZXN1bHQuX2lkO1xuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcbiAgICAgIG5hbWU6IHJlc3VsdC5uYW1lLFxuICAgICAgam9iOiByZXN1bHQuYWJvdXQsXG4gICAgfSk7XG4gICAgdXNlckluZm8uc2V0VXNlckF2YXRhcih7XG4gICAgICBhdmF0YXI6IHJlc3VsdC5hdmF0YXIsXG4gICAgfSk7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgY29uc29sZS5sb2coZXJyKTtcbiAgfSk7XG5cbmNvbnN0IGhhbmRsZUNhcmRMaWtlID0gKGNhcmRJZCwgaXNMaWtlZCkgPT4ge1xuICBpZiAoaXNMaWtlZCkge1xuICAgIGFwaS5zZXREaXNsaWtlZChjYXJkSWQpLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBhcGkuc2V0TGlrZWQoY2FyZElkKS50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XG4gICAgfSk7XG4gIH1cbn07XG5cbmNvbnN0IGhhbmRsZUNhcmREZWxldGUgPSAoY2FyZCwgY2FyZElkKSA9PiB7XG4gIGNvbnN0IHRlbUNlcnRlemEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3RlbUNlcnRlemFcIik7XG4gIHRlbUNlcnRlemEudGV4dENvbnRlbnQgPSBcIkRlbGV0YW5kby4uLlwiO1xuICBhcGlcbiAgICAuZGVsZXRlQ2FyZChjYXJkSWQpXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgY2FyZC5yZW1vdmUoKTtcblxuICAgICAgcG9wdXBXaXRoQ29uZmlybWF0aW9uLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICB0ZW1DZXJ0ZXphLnRleHRDb250ZW50ID0gXCJTaW1cIjtcbiAgICB9KTtcbn07XG5cbmNvbnN0IHBvcHVwV2l0aENvbmZpcm1hdGlvbiA9IG5ldyBQb3B1cFdpdGhDb25maXJtYXRpb24oXG4gIFwiI2RlbGV0ZS1jYXJkXCIsXG4gIGhhbmRsZUNhcmREZWxldGVcbik7XG5wb3B1cFdpdGhDb25maXJtYXRpb24uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmxldCBjYXJkU2VjdGlvbjtcblxuYXBpXG4gIC5nZXRJbml0aWFsQ2FyZHMoKVxuICAudGhlbigocmVzdWx0KSA9PiB7XG4gICAgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAgICAgIHtcbiAgICAgICAgaXRlbXM6IHJlc3VsdCxcbiAgICAgICAgcmVuZGVyZXI6IChjYXJkRGF0YSkgPT4ge1xuICAgICAgICAgIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICAgICAgICAgIGNhcmREYXRhLFxuICAgICAgICAgICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxuICAgICAgICAgICAgaGFuZGxlQ2FyZENsaWNrLFxuICAgICAgICAgICAgKGNhcmQsIGNhcmRJZCkgPT4ge1xuICAgICAgICAgICAgICBwb3B1cFdpdGhDb25maXJtYXRpb24ub3BlbihjYXJkLCBjYXJkSWQpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHVzZXJJZCxcbiAgICAgICAgICAgIChjYXJkSWQsIGlzTGlrZWQpID0+IHtcbiAgICAgICAgICAgICAgaGFuZGxlQ2FyZExpa2UoY2FyZElkLCBpc0xpa2VkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICApO1xuICAgICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5jcmVhdGVDYXJkKCk7XG4gICAgICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgXCIuZWxlbWVudHNcIlxuICAgICk7XG5cbiAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4ge1xuICAgIGNvbnNvbGUubG9nKGVycik7IC8vIHJlZ2lzdHJhIG8gZXJybyBubyBjb25zb2xlXG4gIH0pO1xuXG5jb25zdCB2YWxpZGF0ZSA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5wb3B1cF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19zYXZlLWJ1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19zYXZlLWJ1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwiaW52YWxpZG9cIixcbiAgZXJyb3JDbGFzczogXCJwb3B1cF9fbXNnLWVycm9yXCIsXG59O1xuXG5jb25zdCBwb3B1cFdpdGhJbWFnZSA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIi5pbWFnZV9fcG9wdXBcIik7XG5wb3B1cFdpdGhJbWFnZS5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBoYW5kbGVDYXJkQ2xpY2sgPSAobGluaywgbmFtZSkgPT4ge1xuICBjb25zb2xlLmxvZyhcImVudHJvdVwiKTtcbiAgcG9wdXBXaXRoSW1hZ2Uub3BlbihuYW1lLCBsaW5rKTtcbn07XG5cbmNvbnN0IGVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXG4gIHZhbGlkYXRlLFxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpXG4pO1xuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXG4gIHZhbGlkYXRlLFxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFkZF9fZm9ybVwiKVxuKTtcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXG4gIHZhbGlkYXRlLFxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmF2YXRhcl9fZm9ybVwiKVxuKTtcbmF2YXRhckZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XG4gIG5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fY29udGVudC1uYW1lXCIsXG4gIGpvYlNlbGVjdG9yOiBcIi5wcm9maWxlX19jb250ZW50LWpvYlwiLFxuICBhdmF0YXJTZWxlY3RvcjogXCIucHJvZmlsZV9fY29udGVudC1waWN0dXJlXCIsXG59KTtcblxuY29uc3QgcG9wdXBFZGl0UHJvZmlsZSA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI2VkaXQtcHJvZmlsZVwiLCAoZm9ybURhdGEpID0+IHtcbiAgY29uc3QgYnRuRWRpdFByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2J0bkVkaXRQcm9maWxlXCIpO1xuICBidG5FZGl0UHJvZmlsZS50ZXh0Q29udGVudCA9IFwiU2FsdmFuZG8uLi5cIjtcbiAgY29uc29sZS5sb2coZm9ybURhdGEpO1xuICBhcGlcbiAgICAuc2V0SW5mbyhmb3JtRGF0YS5uYW1lLCBmb3JtRGF0YS50aXRsZSlcbiAgICAudGhlbigocmVzdWx0KSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xuICAgICAgICBuYW1lOiByZXN1bHQubmFtZSxcbiAgICAgICAgam9iOiByZXN1bHQuYWJvdXQsXG4gICAgICB9KTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgYnRuRWRpdFByb2ZpbGUudGV4dENvbnRlbnQgPSBcIlNhbHZhclwiO1xuICAgIH0pO1xuXG4gIHBvcHVwRWRpdFByb2ZpbGUuY2xvc2UoKTtcbn0pO1xucG9wdXBFZGl0UHJvZmlsZS5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBwb3B1cEVkaXRBdmF0YXIgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNlZGl0LWF2YXRhclwiLCAoZm9ybURhdGEpID0+IHtcbiAgY29uc3QgYnRuRWRpdEF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYnRuRWRpdEF2YXRhclwiKTtcbiAgYnRuRWRpdEF2YXRhci50ZXh0Q29udGVudCA9IFwiU2FsdmFuZG8uLi5cIjtcbiAgYXBpXG4gICAgLmVkaXRBdmF0YXIoZm9ybURhdGEuYXZhdGFyKVxuICAgIC50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIoe1xuICAgICAgICBhdmF0YXI6IHJlc3VsdC5hdmF0YXIsXG4gICAgICB9KTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgYnRuRWRpdEF2YXRhci50ZXh0Q29udGVudCA9IFwiU2FsdmFyXCI7XG4gICAgfSk7XG5cbiAgcG9wdXBFZGl0QXZhdGFyLmNsb3NlKCk7XG59KTtcbnBvcHVwRWRpdEF2YXRhci5zZXRFdmVudExpc3RlbmVycygpO1xuY29uc3QgYnRuT3BlbkF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fY29udGVudC1wZW5jaWxcIik7XG5idG5PcGVuQXZhdGFyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIHBvcHVwRWRpdEF2YXRhci5vcGVuKCk7XG59KTtcblxuY29uc3QgcG9wdXBBZGRDYXJkID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjYWRkLWNhcmRcIiwgKGZvcm1EYXRhKSA9PiB7XG4gIGNvbnN0IGJ0bkFkZFN1Ym1pdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYnRuQWRkU3VibWl0XCIpO1xuICBidG5BZGRTdWJtaXQudGV4dENvbnRlbnQgPSBcIkNyaWFuZG8uLi5cIjtcbiAgYXBpXG4gICAgLmFkZE5ld0NhcmQoZm9ybURhdGEubmFtZSwgZm9ybURhdGEuVVJMKVxuICAgIC50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgIGNvbnN0IG5ld0NhcmQgPSBuZXcgQ2FyZChcbiAgICAgICAge1xuICAgICAgICAgIG5hbWU6IHJlc3VsdC5uYW1lLFxuICAgICAgICAgIGxpbms6IHJlc3VsdC5saW5rLFxuICAgICAgICAgIGlzTGlrZWQ6IHJlc3VsdC5pc0xpa2VkLFxuICAgICAgICAgIG93bmVyOiByZXN1bHQub3duZXIsXG4gICAgICAgIH0sXG4gICAgICAgIFwiI2NhcmQtdGVtcGxhdGVcIixcbiAgICAgICAgaGFuZGxlQ2FyZENsaWNrLFxuICAgICAgICAoY2FyZCwgY2FyZElkKSA9PiB7XG4gICAgICAgICAgcG9wdXBXaXRoQ29uZmlybWF0aW9uLm9wZW4oY2FyZCwgY2FyZElkKTtcbiAgICAgICAgfSxcbiAgICAgICAgdXNlcklkLFxuICAgICAgICAoY2FyZElkLCBpc0xpa2VkKSA9PiB7XG4gICAgICAgICAgaGFuZGxlQ2FyZExpa2UoY2FyZElkLCBpc0xpa2VkKTtcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0obmV3Q2FyZC5jcmVhdGVDYXJkKCkpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgYnRuQWRkU3VibWl0LnRleHRDb250ZW50ID0gXCJDcmlhclwiO1xuICAgIH0pO1xuXG4gIHBvcHVwQWRkQ2FyZC5jbG9zZSgpO1xufSk7XG5wb3B1cEFkZENhcmQuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgZWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fY29udGVudC1lZGl0XCIpO1xuZWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjb25zdCB1c2VyID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fbmFtZS1pbnB1dFwiKS52YWx1ZSA9IHVzZXIubmFtZTtcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fdGl0bGUtaW5wdXRcIikudmFsdWUgPSB1c2VyLmpvYjtcbiAgcG9wdXBFZGl0UHJvZmlsZS5vcGVuKCk7XG59KTtcblxuY29uc3QgYWRkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuYWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIHBvcHVwQWRkQ2FyZC5vcGVuKCk7XG59KTtcbiIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVEZWxldGVDYXJkKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2NvbmZpcm1hdGlvbkJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2RlbGV0ZS1jYXJkXCIpO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQgPSBoYW5kbGVEZWxldGVDYXJkO1xuICB9XG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fY29uZmlybWF0aW9uQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkKHRoaXMuX2NhcmQsIHRoaXMuX2NhcmRJZCk7XG4gICAgfSk7XG4gIH1cblxuICBvcGVuKGNhcmQsIGNhcmRJZCkge1xuICAgIHRoaXMuX2NhcmQgPSBjYXJkO1xuICAgIHRoaXMuX2NhcmRJZCA9IGNhcmRJZDtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbn1cbiIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBvcGVuKG5hbWUsIGxpbmspIHtcbiAgICBjb25zdCBwb3B1cEltYWdlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5pbWFnZV9fcG9wdXAtaW1hZ2VcIik7XG4gICAgY29uc3QgcG9wdXBDYXB0aW9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5pbWFnZV9fcG9wdXAtc3VidGl0bGVcIik7XG4gICAgcG9wdXBJbWFnZS5zcmMgPSBsaW5rO1xuICAgIHBvcHVwSW1hZ2UuYWx0ID0gbmFtZTtcbiAgICBwb3B1cENhcHRpb24udGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIiwiZXhwb3J0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGpvYlNlbGVjdG9yLCBhdmF0YXJTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fam9iRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICAgIGpvYjogdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICB9O1xuICB9XG5cbiAgc2V0VXNlckluZm8oeyBuYW1lLCBqb2IgfSkge1xuICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50ID0gam9iO1xuICB9XG5cbiAgc2V0VXNlckF2YXRhcih7IGF2YXRhciB9KSB7XG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudC5zcmMgPSBhdmF0YXI7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJhcGkiLCJjb25zdHJ1Y3RvciIsImJhc2VVcmwiLCJoZWFkZXJzIiwidGhpcyIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJnZXRJbmZvIiwic2V0SW5mbyIsIm5hbWUiLCJhYm91dCIsImNvbnNvbGUiLCJsb2ciLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFkZE5ld0NhcmQiLCJsaW5rIiwic2V0TGlrZWQiLCJjYXJkSWQiLCJzZXREaXNsaWtlZCIsImRlbGV0ZUNhcmQiLCJlZGl0QXZhdGFyIiwiYXZhdGFyIiwiYXV0aG9yaXphdGlvbiIsIkNhcmQiLCJkYXRhIiwidGVtcGxhdGVTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZUNhcmREZWxldGUiLCJ1c2VySWQiLCJoYW5kbGVDYXJkTGlrZSIsIl9uYW1lIiwiX2xpbmsiLCJfaXNMaWtlZCIsImlzTGlrZWQiLCJfaWQiLCJfb3duZXIiLCJvd25lciIsIl90ZW1wbGF0ZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZUNhcmREZWxldGUiLCJfdXNlcklkIiwiX2hhbmRsZUNhcmRMaWtlIiwiX2NyZWF0ZUNhcmRFbGVtZW50IiwiY2FyZEVsZW1lbnQiLCJjbG9uZU5vZGUiLCJjYXJkSW1hZ2UiLCJjYXJkVGl0bGUiLCJjYXJkSGVhcnQiLCJ0cmFzaEljb24iLCJzdHlsZSIsImRpc3BsYXkiLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsImNsYXNzTGlzdCIsInRvZ2dsZSIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9oYW5kbGVIZWFydENsaWNrIiwiZXZ0IiwidGFyZ2V0IiwiX2hhbmRsZVRyYXNoQ2xpY2siLCJjbG9zZXN0IiwiYWRkRXZlbnRMaXN0ZW5lciIsImNyZWF0ZUNhcmQiLCJGb3JtVmFsaWRhdG9yIiwiY29uZmlnIiwiZm9ybUVsZW1lbnQiLCJfY29uZmlnIiwiX2Zvcm1FbGVtZW50IiwiX2lucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwiX2J1dHRvbkVsZW1lbnQiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZSIsImVycm9yRWxlbWVudCIsImlkIiwiYWRkIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9oaWRlSW5wdXRFcnJvciIsInJlbW92ZSIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGFzSW52YWxpZElucHV0Iiwic29tZSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJkaXNhYmxlZCIsImZvckVhY2giLCJlbmFibGVWYWxpZGF0aW9uIiwicHJldmVudERlZmF1bHQiLCJTZWN0aW9uIiwiaXRlbXMiLCJyZW5kZXJlciIsImNvbnRhaW5lclNlbGVjdG9yIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJvcGVuIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9mb3JtIiwiX2dldElucHV0VmFsdWVzIiwiX2lucHV0VmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInJlc2V0IiwicmVzdWx0IiwidXNlckluZm8iLCJzZXRVc2VySW5mbyIsImpvYiIsInNldFVzZXJBdmF0YXIiLCJjYXRjaCIsImVyciIsInBvcHVwV2l0aENvbmZpcm1hdGlvbiIsImhhbmRsZURlbGV0ZUNhcmQiLCJfY29uZmlybWF0aW9uQnV0dG9uIiwiX2hhbmRsZURlbGV0ZUNhcmQiLCJfY2FyZCIsIl9jYXJkSWQiLCJjYXJkIiwidGVtQ2VydGV6YSIsImZpbmFsbHkiLCJjYXJkU2VjdGlvbiIsImNhcmREYXRhIiwidmFsaWRhdGUiLCJmb3JtU2VsZWN0b3IiLCJwb3B1cFdpdGhJbWFnZSIsInBvcHVwSW1hZ2UiLCJwb3B1cENhcHRpb24iLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX25hbWVFbGVtZW50IiwiX2pvYkVsZW1lbnQiLCJfYXZhdGFyRWxlbWVudCIsImdldFVzZXJJbmZvIiwicG9wdXBFZGl0UHJvZmlsZSIsImZvcm1EYXRhIiwiYnRuRWRpdFByb2ZpbGUiLCJ0aXRsZSIsInBvcHVwRWRpdEF2YXRhciIsImJ0bkVkaXRBdmF0YXIiLCJwb3B1cEFkZENhcmQiLCJidG5BZGRTdWJtaXQiLCJVUkwiLCJuZXdDYXJkIiwidXNlciJdLCJzb3VyY2VSb290IjoiIn0=